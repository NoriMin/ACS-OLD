{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\t-tamina\\\\source\\\\repos\\\\Communication\\\\samples\\\\Group Calling Hero Sample\\\\Web\\\\Calling\\\\ClientApp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\t-tamina\\\\source\\\\repos\\\\Communication\\\\samples\\\\Group Calling Hero Sample\\\\Web\\\\Calling\\\\ClientApp\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";// © Microsoft Corporation. All rights reserved.\nimport React,{useEffect}from'react';import{Stack,Toggle,Image,ImageFit}from'@fluentui/react';import{MicIcon,CallVideoIcon}from'@fluentui/react-icons-northstar';import{Constants}from'../core/constants';import{LocalVideoStream,Renderer}from'@azure/communication-calling';import staticMediaSVG from\"../assets/staticmedia.svg\";import{toggleStyle,imgStyles,toggleButtonsBarToken,localPreviewContainerStyle,toggleButtonsBarStyle,localPreviewStyle}from'./styles/LocalPreview.styles';var rendererView;export default(function(props){var imageProps={src:staticMediaSVG.toString(),imageFit:ImageFit.cover,maximizeFrame:true};var handleLocalVideoOnOff=function handleLocalVideoOnOff(_ev){var checked=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var stream=new LocalVideoStream(props.videoDeviceInfo);props.setLocalVideoStream(checked?stream:undefined);};var handleLocalMicOnOff=function handleLocalMicOnOff(_ev){var checked=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;props.setMic(checked);};useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var renderer,container;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!props.localVideoStream){_context.next=7;break;}renderer=new Renderer(props.localVideoStream);_context.next=4;return renderer.createView({scalingMode:'Crop'});case 4:rendererView=_context.sent;container=document.getElementById(Constants.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID);if(container&&container.childElementCount===0){container.appendChild(rendererView.target);}case 7:case\"end\":return _context.stop();}}},_callee);}))();return function(){if(rendererView){rendererView.dispose();}};},[props.localVideoStream]);return/*#__PURE__*/React.createElement(Stack,{className:localPreviewContainerStyle},/*#__PURE__*/React.createElement(Stack,{horizontalAlign:\"center\",verticalAlign:\"center\",id:Constants.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID,className:localPreviewStyle},!props.localVideoStream&&/*#__PURE__*/React.createElement(Image,Object.assign({styles:imgStyles},imageProps))),/*#__PURE__*/React.createElement(Stack,{horizontal:true,horizontalAlign:\"center\",verticalAlign:\"center\",tokens:toggleButtonsBarToken,className:toggleButtonsBarStyle},/*#__PURE__*/React.createElement(CallVideoIcon,{size:\"medium\"}),/*#__PURE__*/React.createElement(Toggle,{onKeyDownCapture:function onKeyDownCapture(e){// if (e.keyCode === 13 && props.localVideoRendererIsBusy) {\n//     e.preventDefault();\n// }\n},styles:toggleStyle,disabled:!props.videoDeviceInfo,onChange:handleLocalVideoOnOff}),/*#__PURE__*/React.createElement(MicIcon,{size:\"medium\"}),/*#__PURE__*/React.createElement(Toggle,{styles:toggleStyle,disabled:!props.audioDeviceInfo,onChange:handleLocalMicOnOff})));});","map":{"version":3,"sources":["C:/Users/t-tamina/source/repos/Communication/samples/Group Calling Hero Sample/Web/Calling/ClientApp/src/components/LocalPreview.tsx"],"names":["React","useEffect","Stack","Toggle","Image","ImageFit","MicIcon","CallVideoIcon","Constants","LocalVideoStream","Renderer","toggleStyle","imgStyles","toggleButtonsBarToken","localPreviewContainerStyle","toggleButtonsBarStyle","localPreviewStyle","rendererView","props","imageProps","src","staticMediaSVG","toString","imageFit","cover","maximizeFrame","handleLocalVideoOnOff","_ev","checked","stream","videoDeviceInfo","setLocalVideoStream","undefined","handleLocalMicOnOff","setMic","localVideoStream","renderer","createView","scalingMode","container","document","getElementById","CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID","childElementCount","appendChild","target","dispose","e","audioDeviceInfo"],"mappings":"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","sourcesContent":["// © Microsoft Corporation. All rights reserved.\r\nimport React, { useEffect } from 'react';\r\nimport { Stack, Toggle, Image, ImageFit } from '@fluentui/react';\r\nimport { MicIcon, CallVideoIcon } from '@fluentui/react-icons-northstar';\r\nimport { Constants } from '../core/constants';\r\nimport {\r\n  RendererView,\r\n  VideoDeviceInfo,\r\n  AudioDeviceInfo,\r\n  LocalVideoStream,\r\n  Renderer\r\n} from '@azure/communication-calling';\r\nimport staticMediaSVG from '../assets/staticmedia.svg';\r\nimport {\r\n  toggleStyle,\r\n  imgStyles,\r\n  toggleButtonsBarToken,\r\n  localPreviewContainerStyle,\r\n  toggleButtonsBarStyle,\r\n  localPreviewStyle\r\n} from './styles/LocalPreview.styles';\r\n\r\nexport interface LocalPreviewProps {\r\n  setMic(mic: boolean): void;\r\n  setLocalVideoStream(device: LocalVideoStream | undefined): void;\r\n  videoDeviceInfo: VideoDeviceInfo;\r\n  audioDeviceInfo: AudioDeviceInfo;\r\n  localVideoStream: LocalVideoStream;\r\n}\r\n\r\nvar rendererView: RendererView;\r\n\r\nexport default (props: LocalPreviewProps): JSX.Element => {\r\n  const imageProps = {\r\n    src: staticMediaSVG.toString(),\r\n    imageFit: ImageFit.cover,\r\n    maximizeFrame: true\r\n  };\r\n\r\n  const handleLocalVideoOnOff = (_ev: React.MouseEvent<HTMLElement>, checked = false): void => {\r\n    var stream = new LocalVideoStream(props.videoDeviceInfo);\r\n    props.setLocalVideoStream(checked ? stream : undefined);\r\n  };\r\n  const handleLocalMicOnOff = (_ev: React.MouseEvent<HTMLElement>, checked = false): void => {\r\n    props.setMic(checked);\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      if (props.localVideoStream) {\r\n        var renderer: Renderer = new Renderer(props.localVideoStream);\r\n        rendererView = await renderer.createView({ scalingMode: 'Crop' });\r\n\r\n        var container = document.getElementById(Constants.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID);\r\n\r\n        if (container && container.childElementCount === 0) {\r\n          container.appendChild(rendererView.target);\r\n        }\r\n      }\r\n    })();\r\n\r\n    return () => {\r\n      if (rendererView) {\r\n        rendererView.dispose();\r\n      }\r\n    };\r\n  }, [props.localVideoStream]);\r\n  return (\r\n    <Stack className={localPreviewContainerStyle}>\r\n      <Stack\r\n        horizontalAlign=\"center\"\r\n        verticalAlign=\"center\"\r\n        id={Constants.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID}\r\n        className={localPreviewStyle}\r\n      >\r\n        {!props.localVideoStream && <Image styles={imgStyles} {...imageProps} />}\r\n      </Stack>\r\n      <Stack\r\n        horizontal\r\n        horizontalAlign=\"center\"\r\n        verticalAlign=\"center\"\r\n        tokens={toggleButtonsBarToken}\r\n        className={toggleButtonsBarStyle}\r\n      >\r\n        <CallVideoIcon size=\"medium\" />\r\n        <Toggle\r\n          onKeyDownCapture={(e) => {\r\n            // if (e.keyCode === 13 && props.localVideoRendererIsBusy) {\r\n            //     e.preventDefault();\r\n            // }\r\n          }}\r\n          styles={toggleStyle}\r\n          disabled={!props.videoDeviceInfo}\r\n          onChange={handleLocalVideoOnOff}\r\n        />\r\n        <MicIcon size=\"medium\" />\r\n        <Toggle styles={toggleStyle} disabled={!props.audioDeviceInfo} onChange={handleLocalMicOnOff} />\r\n      </Stack>\r\n    </Stack>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}